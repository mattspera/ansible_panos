<!DOCTYPE html>
<html>
<head>
<title>TVT - {{ inventory_hostname }}</title>
<style>
table, th, td {
  border: 1px solid black;
  border-collapse: collapse;
}
table.center {
  margin-left: auto; 
  margin-right: auto;
}
th {
  background-color: #FF5D00;
  color: white;
}
th, td {
  padding: 10px;
}
body {
  background-color: #E3E3E3;
}
h1, h2, p {
  text-align: center;
}
</style>
</head>
<body>

<h1>PAN TVT Results</h1>
<h2>Hostname: {{ inventory_hostname }}</h2>
<p>Baseline Facts File: {{ baseline_file }}</p>

<table style="width:80%" class="center">
  <tr>
    <th>Testcase</th>
    <th>Description</th>
    <th>Result</th>
    <th>Changes</th> 
  </tr>
{% for item in tvt_result_lit %}
  <tr>
    <td>{{ item.name }}</td>
{% if item.name == "t_interfaces_up" %}
    <td>
    This testcase is a comparison of baseline list of interfaces 
    that is 'up' and the current interfaces that are 'up' on the 
    firewall. <br>
    If the testcase has returned a 'False' (FAIL) result, the 
    'Changes' column displays what has caused the failure.
    </td>
{% elif item.name == "t_config_diff"  %}
    <td>
    This testcase is a line-by-line comparison of the baseline 
    configuration file and a snapshot of the current configuration 
    on the firewall. <br>
    If the testcase has returned a 'False' (FAIL) result, the 
    'Changes' column displays the differences between the baseline 
    and TVT values in SET command format.
    </td>
{% elif item.name == "t_connectivity"  %}
    <td>
    This testcase is a comparison between the next-hops found and 
    their corresponding packet-liss percentage for each routing table 
    unique next-hop pre-change (baseline) and post-change (TVT) on the 
    firewall.    
    </td>
{% else %}
    <td></td>
{% endif %}
    <td>{{ item.result }}</td>
{% if item.result == False %}
{% if item.name == "t_interfaces_up" %}
    <td>
    Interfaces Down: <br>
    <ul>
{% for int in item.info.interfaces_down %}
        <li>{{ int }}</li>
{% endfor %}
    </ul>
    </td>
{% elif item.name == "t_config_diff"  %}
    <td>
    Set commands added: <br>
    <ul>
{% for cmd in item.info.config_changes.added %}
        <li>{{ cmd }}</li>
{% endfor %}
    </ul>
    Set commands removed: <br>
    <ul>
{% for cmd in item.info.config_changes.removed %}
        <li>{{ cmd }}</li>
{% endfor %}
    </ul>
    </td>
{% elif item.name == "t_connectivity"  %}
    <td>
    Nexthops added: <br>
    <ul>
{% for nexthop in item.info.added %}
        <li>{{ nexthop }}</li>
{% endfor %}
    </ul>
    Nexthops removed: <br>
    <ul>
{% for nexthop in item.info.removed %}
        <li>{{ nexthop }}</li>
{% endfor %}
    </ul>
    Nexthops changed: <br>
    <ul>
{% for nexthop, chg_list in item.info.changed.items() %}
        <li>{{ nexthop }}:
            <ul>
                <li>Baseline packet loss pct: {{ chg_list[0] }}</li>
                <li>TVT packet loss pct: {{ chg_list[1] }}</li>
            </ul>
        </li>      
{% endfor %}
    </ul>
    </td>
{% else %}
    <td></td>
{% endif %}
{% else %}
    <td></td>
{% endif %}
  </tr>
{% endfor %}
</table>

</body>
</html>